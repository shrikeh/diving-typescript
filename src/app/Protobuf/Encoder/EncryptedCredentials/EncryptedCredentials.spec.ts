import { describe, test } from "@jest/globals";
import EncryptedCredentials from "./EncryptedCredentials";

describe("EncryptedCredentials", () => {
  test("It encodes the encrypted credentials", async () => {
    const encryptedCredentials = `
-----BEGIN PGP MESSAGE-----

wV4DDL+5BymeTw8SAQdAx/+9yzJR/2VpgeYvhmU9kGFBd0++x9pPWxAEgUhU
SgswShrEBxCyTVP8NxrtaWIGAHElAEpqkBImoSW4t3U46axoT1t5htflzDHj
jvEk4ufE0mYBRrkCf2v+tQciPaPPKO/7YH2MUUBEmpanWoWAqLU5NWH/3xHx
H9fvUiqJgKf0MLgJSj5/BCncxt9+sOWvNcFUnp76hkRFS9pPZa0WcJ3fgR1d
GslqhzWikONWCyFeaynZ46Ag6sY=
=wwGs
-----END PGP MESSAGE-----
`;
    const encoder = new EncryptedCredentials();
    const encoded = await encoder.encode(encryptedCredentials);

    expect(Buffer.from(encoded).toString("hex")).toBe(
      "0acf020a2d2d2d2d2d424547494e20504750204d4553534147452d2d2d2d2d0a0a77563444444c2b3542796d655477385341516441782f2b39797a4a522f32567067655976686d55396b47464264302b2b7839705057784145675568550a536773775368724542784379545650384e787274615749474148456c414570716b42496d6f535734743355343661786f543174356874666c7a44486a0a6a76456b34756645306d594252726b436632762b74516369506150504b4f2f375948324d555542456d70616e576f5741714c55354e57482f337848780a483966765569714a674b66304d4c674a536a352f42436e637874392b734f57764e6346556e703736686b5246533970505a613057634a3366675231640a47736c71687a57696b4f4e574379466561796e5a343641673673593d0a3d777747730a2d2d2d2d2d454e4420504750204d4553534147452d2d2d2d2d0a"
    );
  });
});
